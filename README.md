ソフトマージン線形SVMによる画像分類器の実装
==============

ソフトマージン線形SVM(Support Vector Machine)を用いた画像分類器を実装した。  
SVMはそのままであれば二値分類しか行えないため，1 vs 1および1 vs otherの手法を用いて多クラス分類器に応用した。

# 環境構築

- numpy 1.18.1
- scikit-image 0.16.2
- cvxopt 1.2.0
- tqdm 4.46.0

# 使用方法

mainモジュールは`main.py`であり、

```
python main.py
```

を実行すると画像分類を開始する。

ただし、学習データとテストデータを用意し、
`main.py`の`if __name__ == '__main__'`部分のパラメータを調整する必要がある。

```python:main.py
if __name__ == '__main__':

    TrainingSampleNum = 2000 # 学習サンプル総数
    TestSampleNum = 100 # テストサンプル総数
    ClassNum = 10 # クラス数（今回は10）
    ImageSize = 28 # 画像サイズ(一辺の長さ)
    TrainingDataFile = './Images/TrainingSamples/{0:1d}-{1:04d}.png' # 学習データのパス
    TestDataFile = './Images/TestSamples/{0:1d}-{1:04d}.png' # テストデータのパス

    # 学習、テストデータをロード
    train_x, train_t = LoadDataset(TrainingDataFile, TrainingSampleNum, ClassNum, ImageSize)
    test_x, test_t = LoadDataset(TestDataFile, TestSampleNum, ClassNum, ImageSize)
    
    # SVM(2値分類器)を作成
    binary_SVM = SVM(ImageSize**2)

    # 多クラス分類器にする
    # 1 vs 1 分類器
    # multi = one_vs_one(binary_SVM, ClassNum, ImageSize**2)
    # 1 vs other 分類器
    multi = one_vs_other(binary_SVM, ClassNum, ImageSize**2)

    # 学習
    multi.train(train_x)
    # 推論
    y = multi.eval(test_x)
    # 検証
    TestResult(y, test_t, ClassNum)
```

**結果:**

1 vs 1
-----

```
    = Confusion matrix ===========
    0009, 0000, 0000, 0000, 0000, 0001, 0000, 0000, 0000, 0000,
    0000, 0010, 0000, 0000, 0000, 0000, 0000, 0000, 0000, 0000,
    0000, 0002, 0006, 0000, 0000, 0000, 0000, 0000, 0002, 0000,
    0000, 0000, 0001, 0004, 0000, 0004, 0001, 0000, 0000, 0000,
    0000, 0000, 0000, 0000, 0007, 0001, 0000, 0000, 0001, 0001,
    0000, 0002, 0000, 0000, 0000, 0008, 0000, 0000, 0000, 0000,
    0000, 0000, 0001, 0000, 0000, 0001, 0008, 0000, 0000, 0000,
    0000, 0000, 0000, 0000, 0000, 0001, 0000, 0009, 0000, 0000,
    0000, 0001, 0000, 0000, 0000, 0002, 0000, 0000, 0007, 0000,
    0000, 0000, 0000, 0000, 0000, 0002, 0000, 0003, 0003, 0002,
    = Total Recognition accuracy ===========
    TOTAL: 0.7000
```

1 vs other
-----

```
    = Confusion matrix ===========
    0010, 0000, 0000, 0000, 0000, 0000, 0000, 0000, 0000, 0000,
    0000, 0010, 0000, 0000, 0000, 0000, 0000, 0000, 0000, 0000,
    0001, 0002, 0006, 0000, 0000, 0000, 0000, 0000, 0001, 0000,
    0001, 0000, 0002, 0003, 0000, 0004, 0000, 0000, 0000, 0000,
    0000, 0000, 0000, 0000, 0008, 0000, 0000, 0001, 0000, 0001,
    0000, 0004, 0001, 0000, 0000, 0005, 0000, 0000, 0000, 0000,
    0001, 0000, 0002, 0000, 0001, 0002, 0004, 0000, 0000, 0000,
    0001, 0001, 0002, 0000, 0002, 0000, 0000, 0004, 0000, 0000,
    0002, 0002, 0000, 0000, 0000, 0000, 0000, 0000, 0006, 0000,
    0002, 0002, 0000, 0000, 0001, 0001, 0000, 0003, 0001, 0000,
    = Total Recognition accuracy ===========
    TOTAL: 0.5600
```

